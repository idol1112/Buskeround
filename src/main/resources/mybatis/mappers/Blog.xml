<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="blog">

	<!-- Create Blog -->
	<insert id="createBlog" parameterType="MypageVo">

		<![CDATA[
		insert into blog(user_no, intro)
		values(#{user_no}, '안녕하세요. ' || #{nickname} || '입니다.')
	 	]]>

	</insert>
	
	<!-- Create Category공지사항 -->
	<insert id="createCategoryNotice" parameterType="int">

		<![CDATA[
		insert into category
		values(seq_cate_no.nextval, #{user_no}, 1, '공지사항')
	 	]]>

	</insert>
	
	<!-- Create Category타임라인 -->
	<insert id="createCategoryTimeline" parameterType="int">

		<![CDATA[
		insert into category
		values(seq_cate_no.nextval, #{user_no}, 2, '타임라인')
	 	]]>

	</insert>
	
	<!-- Create Category갤러리 -->
	<insert id="createCategoryGallery" parameterType="int">

		<![CDATA[
		insert into category
		values(seq_cate_no.nextval, #{user_no}, 3, '갤러리')
	 	]]>

	</insert>
	
	<!-- Create Category방명록-->
	<insert id="createCategoryGuestbook" parameterType="int">

		<![CDATA[
		insert into category
		values(seq_cate_no.nextval, #{user_no}, 4, '방명록')
	 	]]>

	</insert>
	
	<!-- Select Blog -->
	<select id="selectBlog" parameterType="String" resultType="BlogVo">
		<![CDATA[
			SELECT
			    us.user_no,
			    us.id,
			    us.nickname,
			    user_img,
			    us.live,
			    genre,
			    intro,
			    banner,
			    y_url,
			    f_url,
			    i_url,
			    likes,
			    fan
			FROM
			    users  us,
			    blog   bl
			WHERE
			        us.user_no = bl.user_no
			    AND id = #{id}
	 	]]>
	</select>
	
	<!-- Blog(Users) Modify -->
	<update id="usersModify" parameterType="BlogVo">
		
		<![CDATA[
		UPDATE users 
		SET 
			nickname = #{nickname}
		WHERE 
			user_no = #{user_no}
		]]>
		
	</update>
	
	<!-- Blog(Blog) Modify 이미지--> 
	<update id="blogModifyImg" parameterType="BlogVo">
		
		<![CDATA[
		UPDATE blog 
		SET 
			intro = #{intro},
			banner = #{banner},
			y_url = #{y_url},
			i_url = #{i_url},
			f_url = #{f_url}
		WHERE 
			user_no = #{user_no}
		]]>
		
	</update>
	<!-- Blog(Blog) Modify 이미지 없음-->
	<update id="blogModify" parameterType="BlogVo">
		
		<![CDATA[
		UPDATE blog 
		SET 
			intro = #{intro},
			y_url = #{y_url},
			i_url = #{i_url},
			f_url = #{f_url}
		WHERE 
			user_no = #{user_no}
		]]>
		
	</update>
	
	<!-- Blog(Blog) Modify 이미지삭제 -->
	<update id="blogModifyDeleteImg" parameterType="BlogVo">
		
		<![CDATA[
		UPDATE blog 
		SET 
			intro = #{intro},
			banner = null,
			y_url = #{y_url},
			i_url = #{i_url},
			f_url = #{f_url}
		WHERE 
			user_no = #{user_no}
		]]>
		
	</update>
	
	<!-- Blog(resume) Modify -->
	<!-- <update id="resumeModify" parameterType="BlogVo">
		
		<![CDATA[
		UPDATE blog 
		SET 
			nickname = #{nickname},
		WHERE 
			user_no = #{user_no}
		]]>
		
	</update> -->
	
</mapper>